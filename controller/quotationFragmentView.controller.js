sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/Context","sap/m/MessageBox"],function(e,t,o){"use strict";return e.extend("MDG.Help.controller.quotationFragmentView",{onInit:function(){this.oBundle=this.getOwnerComponent().getModel("i18n").getResourceBundle();var e=this;this.getOwnerComponent().getRouter().getRoute("quotationFragmentView").attachPatternMatched(function(o){var a=e.getOwnerComponent().getModel("customerInfo");e.path=o.getParameter("arguments").selectedId;this.getView().getModel("appView").oData.RequestIdSelected=o.getParameter("arguments").selectedId;var n=new t(a,"/"+e.path);e.getView().setModel(new sap.ui.model.json.JSONModel(n.getObject()));e.getView().setModel(new sap.ui.model.json.JSONModel([]),"cartItemSummary");e.handleitemSummary(o.getParameter("arguments").selectedId);e.selectedId=o.getParameter("arguments").selectedId},this);e.maxId=100+e.getOwnerComponent().getModel("customerInfo").getData().length},handleitemSummary:function(e){var t=this;$.ajax({url:"/DanaoStrapi/api/d-products?populate=*&filters[id][$eq]="+e,type:"GET",headers:{"content-type":"application/json"},dataType:"json",success:function(e){t.products=e.data;t.productsArr=[];t.handleitemfinishes()}})},handleitemfinishes:function(e){var t=this;$.ajax({url:"/DanaoStrapi/api/d-customer-quotation-details?populate=*",type:"GET",headers:{"content-type":"application/json"},dataType:"json",success:function(e){t.customerId=e.data.id;var o=e.data;for(var a=0;a<t.products.length;a++){for(var n=0;n<o.length;n++){if(t.products[a].id===o[n].id){t.products[a]["productDetails"]=o[n].attributes;t.selectedQuotationDetails=t.products[a];break}}}console.log(t.products);console.log(t.selectedQuotationDetails);t.getOwnerComponent().getModel("customerQuotModel").oData=t.selectedQuotationDetails;t.getOwnerComponent().getModel("customerQuotModel").updateBindings(true)}})},onNavBack:function(){this.getView().getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("quotationDetail",{id:"tile",QuotationId:"index"})},handleUpdateCancel:function(){this.getView().getModel("appView").setProperty("/layout","TwoColumnsMidExpanded");var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("quotationDetail",{id:"tile",QuotationId:"index"})},handleUpdatePress:function(){var e=this;var t={data:{dProduct_Quantity:e.getView().byId("quantity").getValue().toString()}};$.ajax({url:"/DanaoStrapi/api/d-customer-quotation-details/"+e.selectedId,type:"PUT",headers:{"content-type":"application/json"},data:JSON.stringify(t),dataType:"json",success:function(t){e.handleUpdateCancel();sap.m.MessageBox.success("Quotation has been Updated successfully!")},error:function(e){o.error(e.responseJSON.error.message)}})}})});