var that;sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox"],function(e,t){"use strict";return e.extend("MDG.Help.controller.login",{onInit:function(){that=this;if(window.localStorage.getItem("UserId")=="Raghu"){this.getOwnerComponent().getRouter().navTo("Help")}},onAfterRendering:function(){},handleLoginButtonPress:function(){var e=this;var t=this.getView().byId("emailId").getValue();var s=this.getView().byId("password").getValue();if(t.length==0){this.getView().byId("emailId").setValueState("Error");sap.m.MessageToast.show("Please provide your Email!")}else if(s.length==0){this.getView().byId("password").setValueState("Error");sap.m.MessageToast.show("Please provide your Password!")}else{var a={identifier:t,password:s};$.ajax({url:"/DanaoStrapi/api/auth/local",type:"POST",data:a,dataType:"json",success:function(t){if(t.user.status=="APPROVED"){window.localStorage.setItem("UserId","Raghu");e.getView().getModel("appView").setProperty("/menuBarVisibility",true);e.getView().getModel("appView").setProperty("/layout","OneColumn");e.getOwnerComponent().getRouter().navTo("Help");sap.m.MessageToast.show("LoggedIn Successfully!!");e.getView().byId("emailId").setValue().setValueState("None");e.getView().byId("password").setValue().setValueState("None")}else{sap.m.MessageBox.error("User not Approved")}},error:function(e){sap.m.MessageBox.error("Invalid Credentials!!")}})}},handleSignUpPress:function(e){var t=this;this.getView().byId("signInForm").setVisible(false);this.getView().byId("signUpForm").setVisible(true)},HandleEmail:function(){var e=this.getView().byId("email").getValue();var t=e.indexOf("@");var s=e.lastIndexOf(".");if(t<1||s<t+2||s+2>=e.length){sap.m.MessageBox.error("Please enter valid Email ID")}},PasswordHandle:function(){var e=this.getView().byId("password1").getValue();var t=this.getView().byId("confirmpassword").getValue();if(e!==t){sap.m.MessageBox.error("Password do not Match")}},HandleContactNumber:function(){var e=this.getView().byId("contactnumber").getValue();var t=/^\d+$/;if(!t.test(e))sap.m.MessageBox.error("Please Enter Numbers only")},handleSignUpButtonPress:function(){var e=this;if(this.getView().byId("firstname").getValue().length==0||this.getView().byId("lastname").getValue().length==0||this.getView().byId("email").getValue().length==0||this.getView().byId("contactnumber").getValue().length==0||this.getView().byId("password1").getValue().length==0||this.getView().byId("confirmpassword").getValue().length==0||this.getView().byId("salesType").getValue().length==0||this.getView().byId("companyname").getValue().length==0){sap.m.MessageBox.error("Please fill the mandatoryFields");return""}else{var t=this.getView().byId("firstname").getValue();var s=this.getView().byId("lastname").getValue();var a=this.getView().byId("email").getValue();var i=this.getView().byId("contactnumber").getValue();var r=this.getView().byId("password1").getValue();var n=this.getView().byId("confirmpassword").getValue();var o=this.getView().byId("salesType").getSelectedKey();var l=this.getView().byId("companyname").getValue();var g={firstName:t,lastName:s,company:l,phone:i,email:a,password:r,username:a,d_sales_user_types:o};$.ajax({url:"/DanaoStrapi/api/auth/local/register",type:"POST",data:g,dataType:"json",success:function(t){var s=[];e.getView().byId("signInForm").setVisible(true);e.getView().byId("signUpForm").setVisible(false);sap.m.MessageBox.success("Thank you for signing up. Once your request is approved you can continue to login and access the Estimator tool")},error:function(e){console.log(e)}})}},handleCancelButtonPress:function(){this.getView().byId("signInForm").setVisible(true);this.getView().byId("signUpForm").setVisible(false)}})});